CREATE TABLE Account_Channel (
  ID SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,
  ChanType CHAR(3) NOT NULL,
  PRIMARY KEY(ID),
  UNIQUE INDEX Account_Channel_UNIQ_CT(ChanType)
);

CREATE TABLE AgiInterface (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Sound_Outtro INTEGER UNSIGNED NOT NULL,
  Sound_Intro INTEGER UNSIGNED NOT NULL,
  Name VARCHAR(20) NOT NULL,
  LogIn BOOL NOT NULL,
  PRIMARY KEY(ID),
  INDEX AgiInterface_FKIndex1(Sound_Intro),
  INDEX AgiInterface_FKIndex2(Sound_Outtro)
);

CREATE TABLE AgiLog (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Responsable_Extension INTEGER UNSIGNED NOT NULL,
  LogWhen DATETIME NOT NULL DEFAULT 'now()',
  CallerId VARCHAR(64) NOT NULL,
  Extension BIGINT NOT NULL,
  Price INTEGER UNSIGNED NOT NULL,
  Duration INTEGER UNSIGNED NOT NULL,
  CallStatus VARCHAR(15) NOT NULL,
  PRIMARY KEY(ID),
  INDEX AgiLog_FKIndex1(Responsable_Extension)
);

CREATE TABLE AgiMenu (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Sound_After INTEGER UNSIGNED NULL,
  Sound_Announce INTEGER UNSIGNED NULL,
  Sound_Before INTEGER UNSIGNED NULL,
  Module_Action_ID INTEGER UNSIGNED NULL,
  Module_ID INTEGER UNSIGNED NULL,
  Parent INTEGER UNSIGNED NULL,
  AgiInterface_ID INTEGER UNSIGNED NOT NULL,
  Name VARCHAR(20) NOT NULL,
  Filename VARCHAR(20) NOT NULL,
  Action VARCHAR(10) NOT NULL,
  AccessMask VARCHAR(10) NOT NULL,
  PRIMARY KEY(ID),
  INDEX AgiMenu_FKIndex2(Parent),
  INDEX AgiMenu_FKIndex2(AgiInterface_ID),
  INDEX AgiMenu_FKIndex3(Module_ID, Module_Action_ID),
  INDEX AgiMenu_FKIndex4(Sound_Announce),
  INDEX AgiMenu_FKIndex5(Sound_Before),
  INDEX AgiMenu_FKIndex6(Sound_After)
);

CREATE TABLE AgiSound (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Filename VARCHAR(20) NOT NULL,
  PRIMARY KEY(ID)
);

CREATE TABLE AgiSound_Set (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  AgiSound_ID INTEGER UNSIGNED NOT NULL,
  Priority INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(ID),
  INDEX AgiSound_Set_FKIndex1(AgiSound_ID)
);

CREATE TABLE Extension (
  Extension BIGINT NOT NULL AUTO_INCREMENT,
  Responsable_Extension INTEGER UNSIGNED NOT NULL,
  Module_ID INTEGER UNSIGNED NOT NULL,
  ext_end BIGINT NULL,
  PRIMARY KEY(Extension),
  INDEX extension_FKIndex1(Module_ID),
  INDEX Extension_FKIndex2(Responsable_Extension)
);

CREATE TABLE Geographical_alias (
  Extension SMALLINT UNSIGNED NOT NULL,
  Geographical_Group_Extension INTEGER UNSIGNED NOT NULL,
  People_Extension INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(Extension, Geographical_Group_Extension),
  INDEX Geographical_alias_FKIndex1(Geographical_Group_Extension)
);

CREATE TABLE Geographical_Group (
  Extension INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Name VARCHAR(32) NOT NULL,
  Len SMALLINT UNSIGNED NOT NULL,
  PRIMARY KEY(Extension)
);

CREATE TABLE Grp (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Name VARCHAR(32) NOT NULL,
  PRIMARY KEY(ID)
);

CREATE TABLE Grp_has_People (
  Grp_ID INTEGER UNSIGNED NOT NULL,
  People_Extension INTEGER UNSIGNED NOT NULL,
  PRIMARY KEY(Grp_ID, People_Extension),
  INDEX Groups_has_Peoples_FKIndex1(Grp_ID)
);

CREATE TABLE Iax (
  VoIPAccount_ID INTEGER UNSIGNED NOT NULL,
  VoIPAccount_People_Extension INTEGER UNSIGNED NOT NULL,
  notransfer BOOL NOT NULL,
  host VARCHAR(50) NOT NULL,
  port SMALLINT UNSIGNED NULL,
  PRIMARY KEY(VoIPAccount_ID, VoIPAccount_People_Extension),
  INDEX Iax_FKIndex1(VoIPAccount_People_Extension, VoIPAccount_ID)
);

CREATE TABLE Module (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Name VARCHAR(20) NOT NULL,
  PRIMARY KEY(ID)
);

CREATE TABLE Module_Action (
  Module_ID INTEGER UNSIGNED NOT NULL,
  Action_ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Name VARCHAR(20) NULL,
  Description TEXT NULL,
  PRIMARY KEY(Module_ID, Action_ID),
  INDEX Module_Action_FKIndex1(Module_ID)
);

CREATE TABLE Network (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Name VARCHAR(64) NOT NULL,
  PRIMARY KEY(ID)
);

CREATE TABLE NetworkMask (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Network_ID INTEGER UNSIGNED NOT NULL,
  Mask VARCHAR(16) NOT NULL,
  PRIMARY KEY(ID, Network_ID),
  INDEX NetworkMask_FKIndex1(Network_ID)
);

CREATE TABLE NetworkProvider (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Name VARCHAR(32) NOT NULL,
  PRIMARY KEY(ID)
);

CREATE TABLE NetworkTimeZone (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  AsteriskDescString VARCHAR(64) NOT NULL,
  Name VARCHAR(32) NOT NULL,
  PRIMARY KEY(ID),
  UNIQUE INDEX NetworkTimeZone_Unique(Name)
);

CREATE TABLE People (
  Extension INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  username VARCHAR(32) NOT NULL,
  Name VARCHAR(48) NOT NULL,
  FirstName VARCHAR(48) NOT NULL,
  pwd INTEGER UNSIGNED NOT NULL,
  enable BOOL NOT NULL,
  mail VARCHAR(50) NOT NULL,
  PRIMARY KEY(Extension),
  UNIQUE INDEX People_usernameUniq(username)
);

CREATE TABLE People_PrePay_Settings (
  People_Extension INTEGER UNSIGNED NOT NULL,
  Credit DECIMAL(8,4) NOT NULL DEFAULT '0',
  Announce DECIMAL(1) NOT NULL DEFAULT '1',
  AskHigherCost BOOL NOT NULL,
  AllowOtherCID BOOL NOT NULL,
  PRIMARY KEY(People_Extension)
);

CREATE TABLE Price (
  Network_ID INTEGER UNSIGNED NOT NULL,
  NetworkProvider_ID INTEGER UNSIGNED NOT NULL,
  NetworkTimeZone_ID INTEGER UNSIGNED NOT NULL,
  Price DECIMAL(5,4) NOT NULL,
  ConnectionPrice DECIMAL(5,4) NOT NULL,
  PRIMARY KEY(Network_ID, NetworkProvider_ID, NetworkTimeZone_ID),
  INDEX Price_FKIndex1(Network_ID),
  INDEX Price_FKIndex2(NetworkProvider_ID),
  INDEX Price_FKIndex3(NetworkTimeZone_ID)
);

CREATE TABLE Raw_Extension (
  Extension INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  price DECIMAL(5,4) NOT NULL,
  agi VARCHAR(512) NOT NULL,
  PRIMARY KEY(Extension)
);

CREATE TABLE Rights (
  Grp_ID INTEGER UNSIGNED NOT NULL,
  Module_Action_ID INTEGER UNSIGNED NOT NULL,
  Module_ID INTEGER UNSIGNED NOT NULL,
  Value BOOL NOT NULL,
  PRIMARY KEY(Grp_ID, Module_Action_ID, Module_ID),
  INDEX Rights_FKIndex1(Grp_ID),
  INDEX Right_FKIndex2(Module_ID, Module_Action_ID)
);

CREATE TABLE Sip (
  VoIPAccount_ID INTEGER UNSIGNED NOT NULL,
  VoIPAccount_People_Extension INTEGER UNSIGNED NOT NULL,
  canreinvite BOOL NOT NULL,
  host VARCHAR(50) NULL,
  port SMALLINT UNSIGNED NULL,
  PRIMARY KEY(VoIPAccount_ID, VoIPAccount_People_Extension),
  INDEX Sip_FKIndex1(VoIPAccount_People_Extension, VoIPAccount_ID)
);

CREATE TABLE VoIPAccount (
  People_Extension INTEGER UNSIGNED NOT NULL,
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Account_Channel_ID SMALLINT UNSIGNED NOT NULL,
  Enable BOOL NOT NULL,
  PRIMARY KEY(People_Extension, ID),
  INDEX VoIPAccount_FKIndex1(People_Extension),
  INDEX VoIPAccount_FKIndex2(Account_Channel_ID)
);

CREATE TABLE WebInterface (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Name VARCHAR(20) NOT NULL,
  ScreenName VARCHAR(40) NOT NULL,
  LogIn BOOL NOT NULL,
  PRIMARY KEY(ID)
);

CREATE TABLE WebMenu (
  ID INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  Module_Action_ID INTEGER UNSIGNED NOT NULL,
  Module_ID INTEGER UNSIGNED NOT NULL,
  Parent INTEGER UNSIGNED NULL,
  WebInterface_ID INTEGER UNSIGNED NOT NULL,
  Name VARCHAR(20) NOT NULL,
  ScreenName VARCHAR(40) NOT NULL,
  Filename VARCHAR(20) NOT NULL,
  Action VARCHAR(10) NOT NULL,
  PRIMARY KEY(ID),
  INDEX WebMenu_FKIndex2(Module_ID, Module_Action_ID),
  INDEX WebMenu_FKIndex3(WebInterface_ID),
  INDEX WebMenu_FKIndex3(Parent)
);


